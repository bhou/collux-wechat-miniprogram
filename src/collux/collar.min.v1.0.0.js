!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("freezer-js"),require("object-path"));else if("function"==typeof define&&define.amd)define(["freezer-js","object-path"],t);else{var n="object"==typeof exports?t(require("freezer-js"),require("object-path")):t(e["freezer-js"],e["object-path"]);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(e,t){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":o(e)},i=n(1),u=n(8),a=null,s=[];a||(a=i(u),a.use=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=!0,r=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var f=u.value;s.push(f),a.extend({observers:f.observers()}),f.run()}}catch(e){r=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw i}}return a},a.ns=function(e,t){t&&"object"===("undefined"==typeof t?"undefined":r(t))||(t={}),t.namespace=e;var n=i(u.new(t)),o=!0,a=!1,c=void 0;try{for(var f,l=s[Symbol.iterator]();!(o=(f=l.next()).done);o=!0){var p=f.value;n.extend({observers:p.observers()}),p.run()}}catch(e){a=!0,c=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw c}}return n},a.module=function(e,t,n){n&&"object"===("undefined"==typeof n?"undefined":r(n))||(n={}),n.module=e,t&&"string"==typeof t||(t=e);var o=a.ns(t,n),i=o.input(e+" input"),u=o.output(e+" output");return{ns:function(){return o},in:function(){return i},out:function(){return u},handleMsg:a.toNode(i,u)}}),e.exports=a},function(e,t,n){"use strict";var o=n(2),r=n(12),i=n(17),u=n(18),a=n(19),s=n(21),c=n(22),f=n(25),l=n(26),p=n(27),y=n(28),h=n(29),d=n(30),v=n(31),m=n(32),b=n(33),_=n(16),g=n(24),w=n(34),O=n(35),S=n(23),k={others:{Node:o,Signal:r,registry:g,toNode:S.toNode}},j=[u,c,f,l,d,m,y,b,O,_,s,i,v,p,h,w,a,k];e.exports=function(e){var t=e;return j.forEach(function(e){t=t.extend(e)}),t}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){if(e){var t=e.match(/@(\w+)/);if(null!=t)return t[1]}}function a(e){if(!e)return[];for(var t=/#(\w+)/g,n=[],o=null;null!==(o=t.exec(e));)n.push(o[1]);return n}function s(e){if(!e)return{};var t=u(e),n=a(e),o=e.replace(/@(\w+)/g,"").replace(/#(\w+)/g,"").replace(/^(\s+)/g,"");return{name:t,tags:n,comment:o}}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(o)},p=n(3),y=n(12),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));i._type="node";var u=s(e.comment);return i._name=u.name||i.id,i._comment=u.comment,i._inputs=e.inputs||{},i._outputs=e.outputs||{},i._features=e.features||[],i._tags=u.tags,e.todo&&i.addFeature("todo"),i}return i(t,e),f(t,[{key:"addFeature",value:function(e){return this._features.indexOf(e)<0&&this._features.push(e),this}},{key:"removeFeature",value:function(e){var t=this._features.indexOf(e);return t>=0&&this._features.splice(t,1),this}},{key:"getFeatures",value:function(){return this._features}},{key:"hasFeature",value:function(e){return this._features.indexOf(e)>=0}},{key:"getState",value:function(e,t){t()}},{key:"onSignal",value:function(e){var t=this;return this.accept(e)?(this.act(e,function(e,t){if(e)throw e}),this.process(e,function(e,n){if(e)throw e;t.send(n)}),this):(this.request(),this)}},{key:"send",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e;return y.isSignal(e)||(o=new y(e)),n===!1&&(o=o.setTag("__non_interruptible__",!0)),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,o,n)}},{key:"push",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e;return y.isSignal(e)||(o=new y(e)),n===!1&&(o=o.setTag("__non_interruptible__",!0)),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"push",this).call(this,o,n)}},{key:"watch",value:function(e){}},{key:"accept",value:function(e){return!0}},{key:"act",value:function(e,t){t()}},{key:"process",value:function(e,t){t(null,e)}},{key:"onRequest",value:function(e){return this.onNext(e),this}},{key:"onNext",value:function(e){this.request(e)}},{key:"isInterruptibleSignal",value:function(e){return!e.getTag("__non_interruptible__")}},{key:"isErrorSignal",value:function(e){return y.isSignal(e)&&y.hasError(e)}},{key:"isEndSignal",value:function(e){return y.isSignal(e)&&y.isEnd(e)}},{key:"throwError",value:function(e,t){return this.send(t.setError(e))}},{key:"through",value:function e(o,r,i){var u=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=null;"string"!=typeof o?(a=i,i=r,r=o,s=r._comment):(s=r._comment,r._comment=o),i||(i=r);var c=!0;if(Object.keys(this.meta).length===Object.keys(r.meta).length){var f=!0,p=!1,y=void 0;try{for(var h,d=Object.keys(this.meta)[Symbol.iterator]();!(f=(h=d.next()).done);f=!0){var v=h.value;if("namespace"!==v&&this.meta[v]!==r.meta[v]){c=!1;break}}}catch(e){p=!0,y=e}finally{try{!f&&d.return&&d.return()}finally{if(p)throw y}}if(r.id!==i.id&&Object.keys(this.meta).length===Object.keys(i.meta).length){var m=!0,b=!1,_=void 0;try{for(var g,w=Object.keys(this.meta)[Symbol.iterator]();!(m=(g=w.next()).done);m=!0){var O=g.value;if("namespace"!==O&&this.meta[O]!==i.meta[O]){c=!1;break}}}catch(e){b=!0,_=e}finally{try{!m&&w.return&&w.return()}finally{if(b)throw _}}}}else c=!1;if(c)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,r),i?i:r;var e=n(16).through,S=e(r._comment,r,i,a);return r._comment=s,Object.keys(this.meta).forEach(function(e){Object.prototype.hasOwnProperty.call(u.meta,e)&&(Object.prototype.hasOwnProperty.call(r.meta,e)||r.preventMetaPropagation()||(r.meta[e]=u.meta[e]),S.meta[e]=u.meta[e])}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,S)}},{key:"to",value:function(e,n){var o=this;if("string"==typeof e){if(n._comment=e,!n)return this}else if(n=e,!n)return this;return Object.keys(this.meta).forEach(function(e){Object.prototype.hasOwnProperty.call(o.meta,e)&&(Object.prototype.hasOwnProperty.call(n.meta,e)||n.preventMetaPropagation()||(n.meta[e]=o.meta[e]))}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,n)}},{key:"preventMetaPropagation",value:function(){return!1}},{key:"getTags",value:function(){return this._tags}},{key:"hasTag",value:function(e){return this._tags.indexOf(e)>=0}},{key:"addTag",value:function(e){this._tags.push(e)}},{key:"delTag",value:function(e){var t=this._tags.indexOf(e);t>=0&&this._tags.splice(t,1)}},{key:"getMeta",value:function(){return this.meta}},{key:"getMetaByName",value:function(e){return this.meta[e]}},{key:"addMeta",value:function(e,t){this.meta[e]=t}},{key:"getNamespace",value:function(){return this.meta.namespace}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,namespace:this.namespace,fullName:this.fullName,features:this.getFeatures(),meta:this.meta,tags:this.tags,comment:this.comment,inputs:this.inputs,outputs:this.outputs}}},{key:"name",get:function(){return this._name}},{key:"fullName",get:function(){return this.meta.namespace?this.meta.namespace+"."+this._name:this._name}},{key:"tags",get:function(){return this._tags}},{key:"namespace",get:function(){return this.getNamespace()}},{key:"comment",get:function(){return this._comment}},{key:"type",get:function(){return this._type}},{key:"inputs",get:function(){return this._inputs},set:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t._inputs[e]=""}):this._inputs=e,this}},{key:"outputs",get:function(){return this._outputs},set:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t._outputs[e]=""}):this._outputs=e,this}}]),t}(p);e.exports=h},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(4),u=i.uuid,a=i.EventEmitter,s=i.setImmediate,c=function(){function e(t,n){o(this,e),this.id=u.v1(),this.options=t,e.shareEE?this.ee=e.ee:this.ee=n||new a,this.obs=[],this.ups={},this.downs={},this.meta={}}return r(e,[{key:"push",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n!==!1&&this.isInterruptibleSignal(e)?(s(function(){t.onReceive(e)}),this):(this.onReceive(e),this)}},{key:"onReceive",value:function(e){if(this.invokeObservers("onReceive",e),this.isErrorSignal(e))this.onError(e),this.request();else if(this.isEndSignal(e))try{this.onEnd(e)}catch(t){this.throwError(t,e)}else try{this.onSignal(e)}catch(t){this.throwError(t,e)}return this}},{key:"onSignal",value:function(e){return this.send(e),this}},{key:"onError",value:function(e){return this.send(e),this}},{key:"onEnd",value:function(e){return this.send(e),this}},{key:"send",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.invokeObservers("send",e),n!==!1&&this.isInterruptibleSignal(e)?(s(function(){t.ee.emit("outgoing-"+t.id,e)}),this):(Object.keys(this.downs).forEach(function(n){t.downs[n].onReceive(e)}),this)}},{key:"observe",value:function(e){return this.obs.push(e),this}},{key:"to",value:function(e){var t=this;return this.invokeObservers("to",e),this.downs[e.id]=e,this.ee.on("outgoing-"+this.id,function(t){e.push(t)}),e.ee.on("request-"+e.id,function(e){t.pull(e)}),e.from(this),e}},{key:"pull",value:function(e){var t=this;return s(function(){t.onRequest(e)}),this}},{key:"onRequest",value:function(e){return this.invokeObservers("onRequest",e),this.request(e),this}},{key:"request",value:function(e){var t=this;return this.invokeObservers("request",e),s(function(){t.ee.emit("request-"+t.id,e)}),this}},{key:"from",value:function(e){return this.ups[e.id]=e,this.invokeObservers("from",e),this}},{key:"isInterruptibleSignal",value:function(e){return!0}},{key:"isErrorSignal",value:function(e){return e instanceof Error}},{key:"isEndSignal",value:function(t){return t===e.END}},{key:"throwError",value:function(e,t){return e.signal=t,this.send(e)}},{key:"invokeObservers",value:function(e){for(var t=this,o=arguments.length,r=Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];r.unshift(e),r.unshift(this);try{!function(){var e=n(8).observers;Object.keys(e).forEach(function(n){e[n].apply(t,r)}),t.obs.forEach(function(e){e.apply(t,r)})}()}catch(e){console.error(e.message)}}}]),e}();c.shareEE=!1,c.ee=new a,c.END="__SIGNAL_END__",e.exports=c},function(e,t,n){"use strict";var o=n(5),r=n(6),i=n(7);e.exports={uuid:o,EventEmitter:r,setImmediate:i}},function(e,t){"use strict";function n(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,n)}function n(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,n)}e.exports={v1:n}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){n(this,e),this.listeners={}}return o(e,[{key:"on",value:function(e,t){Object.prototype.hasOwnProperty.call(this.listeners,e)||(this.listeners[e]=[]);var n=this.listeners[e];n.push(t)}},{key:"emit",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this.listeners,e)){var n=this.listeners[e];n.forEach(function(e){return e(t)})}}}]),e}();e.exports=r},function(e,t){"use strict";e.exports=function(e){return setTimeout(e,0)}},function(e,t,n){"use strict";function o(e,t){return Object.assign(t,e)}function r(){function e(e){var t=!0,n=!1,o=void 0;try{for(var r,i=d._indexers.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var u=r.value;u(e)}}catch(e){n=!0,o=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw o}}}function t(t,n){function r(){var t=n.apply(void 0,arguments);return t.meta={},o(this.meta,t.meta),e(t),this.to(t)}return d.reserved.indexOf(t)>=0?(console.warn("can't add operator '"+t+"', name is reserved."),d):(i.prototype[t]=r,d[t]=function(){var t=n.apply(void 0,arguments);return t.meta={},o(d._meta,t.meta),e(t),t},d)}function r(e){Object.keys(e).forEach(function(t){d.addOperator(t,e[t])})}function u(t,n){return d.reserved.indexOf(t)>=0?(console.warn("can't add source '"+t+"', name is reserved. "),d):(d[t]=function(){var t=n.apply(void 0,arguments);return t.meta={},o(d._meta,t.meta),e(t),t},d)}function a(e){return Object.keys(e).forEach(function(t){d.addSource(t,e[t])}),d}function s(e,t){return d[e]=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.query.apply(t,[d].concat(n))},d}function c(e,t){return d._indexers.set(e,function(e){t.index(d,e)}),d}function f(e){var t=e;return"string"==typeof e&&(t=n(9)(e)),t.operators&&d.addOperators(t.operators),t.sources&&d.addSources(t.sources),t.observers&&Object.keys(t.observers).forEach(function(e){d.observers[e]=t.observers[e]}),t.indexers&&Object.keys(t.indexers).forEach(function(e){d.addIndexer(e,t.indexers[e])}),t.queriers&&Object.keys(t.queriers).forEach(function(e){d.addQuerier(e,t.queriers[e])}),t.others&&Object.keys(t.others).forEach(function(e){d[e]=t.others[e]}),d}function l(e){d._meta=e}function p(e,t){d._meta[e]=t}function y(e){d._meta.hasOwnProperty(e)&&delete d._meta[e]}var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d={};return d._meta=h,d._indexers=new Map,d.Node=i,d.Bouton=i,d.END=i.END,d.reserved=["id","options","ee","observers","upstreams","downstreams","meta","push","onReceive","onSignal","onError","onEnd","send","observe","to","pull","onRequest","request","from","isErrorSignal","isEndSignal","throwError","invokeObservers"],d.addOperator=t,d.addOperators=r,d.addSource=u,d.addSources=a,d.addQuerier=s,d.addIndexer=c,d.observers={},d.extend=f,d.setMeta=l,d.addMeta=p,d.removeMeta=y,d}var i=n(3),u=r();u.new=r,e.exports=u},function(e,t,n){function o(e){return n(r(e))}function r(e){return i[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var i={"./Bouton":3,"./Bouton.js":3,"./dep":4,"./dep.js":4,"./index":8,"./index.js":8,"./operators":10,"./operators.js":10,"./sources":11,"./sources.js":11};o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=9},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":d(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":d(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){var t=this.fn(e);this.send(t)}}]),t}(m);return new t(e)}function a(e){var t=function(t){function n(e,t){o(this,n);var i=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return i.fn=e,i}return i(n,t),v(n,[{key:"onSignal",value:function(t){e(t)?this.send(t):this.request()}}]),n}(m);return new t(e)}function s(e,t){var n=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.memo=i.options.memo,i.iterator=i.options.iterator,i.END=!1,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.memo=this.iterator.call(this,this.memo,e),this.request()}},{key:"onEnd",value:function(){this.send(this.memo),this.END=!0}},{key:"onRequest",value:function(e){this.END?this.send(m.END):this.request()}}]),t}(m);return new n({memo:e,iterator:t})}function c(e){var t=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onError",value:function(e){var t=this;this.fn(e,function(e){t.send(e)})}}]),t}(m);return new t(e)}function f(){var e=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.request()}},{key:"from",value:function(e){this.request()}}]),t}(m);return new e}function l(e){var t=(new Date).getTime(),n=function(n){function u(){return o(this,u),r(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return i(u,n),v(u,[{key:"onSignal",value:function(n){var o=(new Date).getTime();o-e>=t&&(t=o,this.send(n))}}]),u}(m);return new n(e)}function p(e,t){var n=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.n=e.n,i.add=e.add,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.n=this.add.call(this,this.n,e),this.send(this.n)}}]),t}(m);return new n({n:e,add:t})}function y(e){var t=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.fn(e),this.send(e)}}]),t}(m);return new t(e)}function h(e){var t=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onEnd",value:function(e){this.fn(e)}}]),t}(m);return new t(e)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),m=n(3);e.exports={operators:{map:u,filter:a,reduce:s,errors:c,sink:f,throttle:l,scan:p,act:y,done:h}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return new l(e)}function a(e){return new p(e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=n(3),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.source=i.options,i.index=0,i}return i(t,e),c(t,[{key:"onRequest",value:function(e){this.source.length===this.index?(this.send(f.END),this.index++):this.source.length>this.index&&(this.send(this.source[this.index]),this.index++)}}]),t}(f),p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.value=i.options,i.visited=0,i}return i(t,e),c(t,[{key:"onRequest",value:function(e){0==this.visited?(this.send(this.value),this.visited++):1==this.visited&&(this.send(f.END),this.visited++)}}]),t}(f);e.exports={sources:{asList:u,just:a}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":r(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(4),s=n(13),c=a.uuid,f=s.Immutable,l=function(){function e(t,n){if(o(this,e),f.isImmutable(t))this._immu=t;else if(t instanceof Error)this._immu=f.fromJS({__type__:"Signal",_seq:c.v1(),_cmd:n,_error:t,_end:!1,_payload:{},_tags:{}});else{"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t&&"undefined"!=typeof t&&null!==t||(t={__anon__:t});var r=c.v1(),u={},a=null,s=!1,l=t,p=n||null;"object"===("undefined"==typeof t?"undefined":i(t))&&(t.hasOwnProperty("_seq")&&(r=t._seq),t.hasOwnProperty("_tags")&&(u=t._tags),t.hasOwnProperty("_error")&&(a=t._error),t.hasOwnProperty("_end")&&(s=t._end),t.hasOwnProperty("_payload")&&(l=t._payload),t.hasOwnProperty("_cmd")&&(p=t._cmd)),this._immu=f.fromJS({__type__:"Signal",_seq:r,_cmd:p,_error:a,_end:s,_payload:l,_tags:u})}}return u(e,[{key:"toJSON",value:function(){return this._immu.toJSON()}},{key:"setFrom",value:function(e){return this._from.push(e),this}},{key:"new",value:function(t){var n=this.seq;return new e(t).setSeq(n).setTags(this.tags)}},{key:"get",value:function(e){var t=e;"string"==typeof e&&(t=e.split(".")),t.unshift("_payload");var n=this._immu.getIn(t);return f.readyToJS(n)?n.toJS():n}},{key:"set",value:function(t,n){var o=t;return"string"==typeof t&&(o=t.split(".")),o.unshift("_payload"),new e(this._immu.setIn(o,n))}},{key:"getAnonPayload",value:function(){return this.get("__anon__")}},{key:"setPayload",value:function(t){return"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t&&"undefined"!=typeof t&&null!==t||(t={__anon__:t}),new e(this._immu.set("_payload",t))}},{key:"getResult",value:function(){return this.get("__result__")}},{key:"setResult",value:function(e){return this.set("__result__",e)}},{key:"del",value:function(t){var n=t;return"string"==typeof t&&(n=t.split(".")),n.unshift("_payload"),new e(this._immu.deleteIn(n))}},{key:"setTags",value:function(t){return new e(this._immu.set("_tags",t))}},{key:"getTag",value:function(e){var t=this._immu.getIn(["_tags",e]);return f.readyToJS(t)?t.toJS():t}},{key:"getCmd",value:function(e){var t=e;"string"==typeof e&&(t=e.split(".")),t.unshift("_cmd");var n=this._immu.getIn(t);return f.readyToJS(n)?n.toJS():n}},{key:"setCmd",value:function(t,n){var o=t;return"string"==typeof t&&(o=t.split(".")),o.unshift("_cmd"),new e(this._immu.setIn(o,n))}},{key:"delCmd",value:function(t){var n=t;return"string"==typeof t&&(n=t.split(".")),n.unshift("_cmd"),new e(this._immu.deleteIn(n))}},{key:"setTag",value:function(t,n){return new e(this._immu.setIn(["_tags",t],n))}},{key:"delTag",value:function(t){return new e(this._immu.deleteIn(["_tags",t]))}},{key:"setSeq",value:function(t){return new e(this._immu.set("_seq",t))}},{key:"setError",value:function(t){return new e(this._immu.set("_error",t))}},{key:"setEnd",value:function(t){return new e(this._immu.set("_end",t))}},{key:"hasError",value:function(){return this.error instanceof Error}},{key:"isEnd",value:function(){return this.end}},{key:"__type__",get:function(){return this._immu.get("__type__")}},{key:"seq",get:function(){return this._immu.get("_seq")}},{key:"id",get:function(){return this._immu.get("_seq")}},{key:"payload",get:function(){var e=this._immu.get("_payload");return f.readyToJS(e)?e.toJS():e}},{key:"anonPayload",get:function(){return this.get("__anon__")}},{key:"error",get:function(){return this._immu.get("_error")}},{key:"end",get:function(){return this._immu.get("_end")}},{key:"tags",get:function(){var e=this._immu.get("_tags");return f.readyToJS(e)?e.toJS():e}},{key:"from",get:function(){return this._from}}],[{key:"isSignal",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&"Signal"===e.__type__}},{key:"hasError",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&e.error instanceof Error}},{key:"isEnd",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&e.end}},{key:"Error",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t){var n=t;return"string"==typeof t&&(n=new Error(t)),new e(t)})},{key:"End",value:function(){var t=new e;return t.setEnd(!0)}}]),e}();e.exports=l},function(e,t,n){"use strict";var o=n(14);e.exports={Immutable:o}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":r(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(15),s=function(){function e(t){o(this,e),this.__type__="CollarImmutable",this.state=new a(t).get()}return u(e,[{key:"get",value:function(e){return this.state[e]}},{key:"getIn",value:function(e){for(var t="string"==typeof e?e.split("."):e,n=this.state,o=0;o<t.length;o++){if(!n.hasOwnProperty(t[o]))return null;n=n[t[o]]}return n}},{key:"set",value:function(t,n){var o=new a(this.state.toJS());return o.get().set(t,n),new e(o.get().toJS())}},{key:"setIn",value:function(t,n){for(var o="string"==typeof t?t.split("."):t,r=new a(this.state.toJS()),u=r.get(),s=0;s<o.length;s++){if(u.hasOwnProperty(o[s]))if(s===o.length-1)u=u.set(o[s],n);else{var c=u[o[s]];c&&"object"===("undefined"==typeof c?"undefined":i(c))||(u=u.set(o[s],{}))}else u=s===o.length-1?u.set(o[s],n):u.set(o[s],{});u=u[o[s]]}return new e(r.get().toJS())}},{key:"deleteIn",value:function(t){for(var n="string"==typeof t?t.split("."):t,o=new a(this.state.toJS()),r=o.get(),i=0;i<n.length;i++)if(i<n.length-1){if(r=r[n[i]],null===r)return new e(this.freezer.get())}else r.remove(n[i]);return new e(o.get().toJS())}},{key:"toJSON",value:function(){return this.state.toJS()}}],[{key:"fromJS",value:function(t){return new e(t)}},{key:"isImmutable",value:function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"CollarImmutable"===e.__type__}},{key:"readyToJS",value:function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"Object"===e.constructor.name&&e.toJS}}]),e}();s.Iterable=function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"CollarImmutable"===e.__type__},e.exports=s},function(e,t){e.exports=require("freezer-js")},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=null;return"string"==typeof e?r={comment:e,input:t,output:n,asActuator:o}:"string"!=typeof e&&(r={input:e,output:t,asActuator:n}),new p(r)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=100,l=1e4,p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="delegator",i._inputDelegation=e.input,i._outputDelegation=e.output||e.input,i.addFeature("delegator"),e.asActuator?(i._asActuator=!0,i.addFeature("actuator")):(i._asActuator=!1,i.addFeature("processor")),i._receivedSignals=new Map,i._outputDelegation.observe(function(e,t,n){if("send"===t){if(i._receivedSignals.has(n.id)){var o=i._receivedSignals.get(n.id).signal;i._receivedSignals.delete(n.id),i._asActuator?n.error?i.send(o.setResult(n.payload).setError(n.error)):n.end?i.send(o.setResult(n.payload).setEnd(!0)):i.send(o.setResult(n.payload)):i.send(n)}i.checkExpiredSession()}}),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){this._receivedSignals.set(e.id,{timestamp:(new Date).getTime(),signal:e}),this._inputDelegation.push(e);
}},{key:"checkExpiredSession",value:function(){var e=this;this._receivedSignals.size>f&&!function(){var t=(new Date).getTime();Object.keys(e._receivedSignals).forEach(function(n){t<e._receivedSignals.get(n).timestamp+l&&e._receivedSignals.delete(n)})}()}}]),t}(c);e.exports={operators:{delegate:u},through:u}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={comment:e,source:t};return Array.isArray(e)&&(n.comment=null,n.source=e),new y(n)}function a(e,t){var n={comment:e,source:t};return t||(n.comment=null,n.source=e),new h(n)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(o)},l=n(2),p=n(12),y=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="passive",i.addFeature("passive"),i._comment=e.comment||"passive array source",i.source=e.source,i.index=0,i}return i(t,e),c(t,[{key:"onNext",value:function(){this.source.length===this.index?(this.send((new p).setEnd(!0)),this.index++):this.source.length>this.index&&(this.send(new p(this.source[this.index])),this.index++)}},{key:"send",value:function(e){p.isSignal(e)?f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,e.setCmd("mode","passive")):f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,new p(e,{mode:"passive"}))}}]),t}(l),h=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.addFeature("passive"),i._comment=e.comment||"passive array source",i.source=e.source,i.visited=0,i}return i(t,e),c(t,[{key:"onNext",value:function(){0===this.visited?(this.send(new p(this.source)),this.visited++):1===this.visited&&(this.send((new p).setEnd(!0)),this.visited++)}},{key:"send",value:function(e){p.isSignal(e)?f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,e.setCmd("mode","passive")):f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,new p(e,{mode:"passive"}))}}]),t}(l);e.exports={sources:{asList:u,just:a}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){"function"==typeof e&&(t=e,e="sensor");var n={comment:e,fn:t};return n.fn||(n.todo=!0),new f(n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="sensor",i.fn=e.fn||function(){},i.addFeature("sensor"),i.addFeature("active"),i.watch(i.options),i}return i(t,e),s(t,[{key:"watch",value:function(e){this.fn.call(this,e)}}]),t}(c);e.exports={sources:{sensor:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){return new l({comment:e,name:t,value:n})}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=n(20),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="variable",i._value=i.options.value||0==i.options.value?i.options.value:{},i._name=i.options.name,i._comment=i.options.comment||"var '"+i._name+"'",i.addFeature("variable"),i.addFeature("active"),i.inputs={value:"the new value"},i.outputs={type:"always be 'variableChanged'",value:"new value of the variable",before:"old value"},i}return i(t,e),s(t,[{key:"get",value:function(e){return f.get(this._value,e)}},{key:"set",value:function(e,t){if(!e||""===e)return void(this.value=t);var n=f.get(this._value,e);f.set(this._value,e,t),this.send({type:"variableChanged",value:this._value,before:n})}},{key:"onSignal",value:function(e){var t=e.get("value");this.value=t}},{key:"value",get:function(){return this._value},set:function(e){var t=this._value;this._value=e,this.send({type:"variableChanged",value:this._value,before:t})}}]),t}(c);e.exports={Variable:l,operators:{variable:u}}},function(e,t){e.exports=require("object-path")},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){return new l({comment:e,name:t,value:n})}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=n(20),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="model",i._value=i.options.value||0==i.options.value?i.options.value:{},i._name=i.options.name,i._comment=i.options.comment||'model "'+i._name+'"',i.addFeature("model"),i.addFeature("active"),i.addFeature("stateful"),i.inputs={operation:'one of "set", "insert", "append", and "delete"',path:"the path to make de operation, empty for root",index:'optional, only need for "insert"',value:'optional, only need for "set", "insert", and "append"'},i.outputs={type:'always be "modelChanged"',operation:'the operation that causes the change, one of "set", "insert", "append", and "delete"',path:"where does the change happen",value:"the value of the model",appended:"the appended value",index:"the position of the newly inserted value",inserted:"the inserted value",before:"old value of the changed part",after:"new value of the changed part"},i}return i(t,e),s(t,[{key:"get",value:function(e){return f.get(this._value,e)}},{key:"set",value:function(e,t,n){if(!e||""===e){var o=this._value;return this._value=t,void(n?this.send(n.new({type:"modelChanged",operation:"set",path:null,value:this._value,before:o,after:this._value})):this.send({type:"modelChanged",operation:"set",path:null,value:this._value,before:o,after:this._value}))}var r=f.get(this._value,e);f.set(this._value,e,t),n?this.send(n.new({type:"modelChanged",operation:"set",path:e,value:this._value,before:r,after:t})):this.send({type:"modelChanged",operation:"set",path:e,value:this._value,before:r,after:t})}},{key:"insert",value:function(e,t,n,o){var r=f.get(this._value,e);f.insert(this._value,e,t,n),o?this.send(o.new({type:"modelChanged",operation:"insert",path:e,index:n,value:this._value,inserted:t,before:r,after:f.get(this._value,e)})):this.send({type:"modelChanged",operation:"insert",path:e,index:n,value:this._value,inserted:t,before:r,after:f.get(this._value,e)})}},{key:"append",value:function(e,t,n){var o=this,r=f.get(this._value,e);Array.isArray(t)?t.forEach(function(t){f.push(o._value,e,t)}):f.push(this._value,e,t),n?this.send(n.new({type:"modelChanged",operation:"append",path:e,value:this._value,appended:t,before:r,after:f.get(this._value,e)})):this.send({type:"modelChanged",operation:"append",path:e,value:this._value,appended:t,before:r,after:f.get(this._value,e)})}},{key:"del",value:function(e,t){var n=f.get(this._value,e);f.del(this._value,e),t?this.send(t.new({type:"modelChanged",operation:"delete",path:e,value:this._value,before:n,after:null})):this.send({type:"modelChanged",operation:"delete",path:e,value:this._value,before:n,after:null})}},{key:"onSignal",value:function(e){var t=e.get("operation")||"set";if("set"===t){var n=e.get("path");this.set(n,e.get("value"),e)}else if("insert"===t){var n=e.get("path"),o=e.get("index");n&&null!=o&&void 0!=o&&this.insert(n,e.get("value"),o,e)}else if("append"===t){var n=e.get("path");n&&this.append(n,e.get("value"),e)}else if("delete"===t){var n=e.get("path");n&&this.del(n,e)}}},{key:"getState",value:function(e,t){t(null,this._value)}},{key:"value",get:function(){return this._value},set:function(e){var t=this._value;this._value=e,this.send({type:"modelChanged",operation:"set",path:null,value:this._value,before:t,after:this._value})}}]),t}(c);e.exports={sources:{model:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,o){return new p(f.prepareNodeOptions(e,t,n,o,"filter"))}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=n(23),l=n(24),p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="filter",i._comment||(i._comment="filter"),i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",o=l.getFn(""+n+this.name);return o?o.call(this,t):!e.fn||e.fn.call(this,t)},i.addFeature("filter"),i}return i(t,e),s(t,[{key:"accept",value:function(e){return this.fn(e)}},{key:"onSignal",value:function(e){this.accept(e)?this.send(e):this.request()}}]),t}(c);e.exports={operators:{filter:u,when:u}}},function(e,t,n){"use strict";function o(e,t){return t._node_callbacks||(t._node_callbacks={}),e._to_node_funcs||(e._to_node_funcs={}),t._to_node_observer||(t._to_node_observer=function(e,n,o){if("send"===n){var r=o.getTag("__to_node_dest__");if(!r||r!==t.id)return;var i=t._node_callbacks[o.id];if(!i)return;delete t._node_callbacks[o.id],o.error?i(o.error,o.payload):i(null,o.payload)}},t.observe(t._to_node_observer)),Object.prototype.hasOwnProperty.call(e._to_node_funcs,t.id)?e._to_node_funcs[t.id]:(e._to_node_funcs[t.id]=function(n,o){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=n;r.isSignal(u)||(u=new r(n)),u=u.setTag("__to_node_dest__",t.id),t._node_callbacks[u.id]=o,e.push(u,i)},e._to_node_funcs[t.id])}var r=n(12);e.exports={prepareNodeOptions:function(e,t,n,o,r){return"function"==typeof e?r?{comment:r,fn:e}:{fn:e}:"function"==typeof t?{comment:e,fn:t}:"function"==typeof n?{comment:e,inputs:t,fn:n}:"function"==typeof o?{comment:e,inputs:t,outputs:n,fn:o}:o?{}:{comment:e,inputs:t,outputs:n,fn:o,todo:!0}},toNode:o}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){n(this,e),this.registry={}}return o(e,[{key:"register",value:function(e,t,n){return this.registry[e]={type:t,fn:n},this}},{key:"registerActuatorSync",value:function(e,t){return this.register(e,"actuator.sync",t)}},{key:"registerActuatorAsync",value:function(e,t){return this.register(e,"actuator.async",t)}},{key:"registerProcessorSync",value:function(e,t){return this.register(e,"processor.sync",t)}},{key:"registerProcessorAsync",value:function(e,t){return this.register(e,"processor.async",t)}},{key:"registerFilter",value:function(e,t){return this.register(e,"filter",t)}},{key:"remove",value:function(e){Object.prototype.hasOwnProperty.call(this.registry,e)&&delete this.registry[e]}},{key:"clear",value:function(){this.registry={}}},{key:"get",value:function(e){return Object.prototype.hasOwnProperty.call(this.registry,e)?this.registry[e]:null}},{key:"getFn",value:function(e){return Object.prototype.hasOwnProperty.call(this.registry,e)?this.registry[e].fn:null}}]),e}(),i=null;e.exports=null==i?i=new r:i},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,o){return new y(l.prepareNodeOptions(e,t,n,o,"actuator"))}function a(e,t,n,o){return new h(l.prepareNodeOptions(e,t,n,o,"actuator"))}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=n(2),l=n(23),p=n(24),y=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="actuator",i.fn=function(t,n){var o=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",r=p.getFn(""+o+this.name);return r?r.call(this,t,n):e.fn?e.fn.call(this,t,n):void n()},i.addFeature("actuator"),i}return i(t,e),c(t,[{key:"act",value:function(e,t){this.fn.call(this,e,t)}},{key:"onSignal",value:function(e){var t=this;this.act(e,function(n,o){return n?void t.throwError(n,e):void(o||0===o||o===!1||""===o?t.send(e.set("__result__",o)):t.send(e))})}}]),t}(f),h=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="actuator.sync",i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",o=p.getFn(""+n+this.name);return o?o.call(this,t):e.fn?e.fn.call(this,t):void 0},i.addFeature("actuator"),i}return i(t,e),c(t,[{key:"act",value:function(e,t){var n=this.fn.call(this,e);t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.act(e,function(n,o){if(n)throw n;o||0===o||o===!1||""===o?t.send(e.set("__result__",o)):t.send(e)})}}]),t}(f);e.exports={operators:{actuator:u,actuatorSync:a,do:a},Actuator:y}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,o){return new h(p.prepareNodeOptions(e,t,n,o,"processor"))}function a(e,t,n,o){return new d(p.prepareNodeOptions(e,t,n,o,"processor"))}function s(e,t,n,o){return new d(p.prepareNodeOptions(e,t,n,o,"map"))}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(2),p=n(23),y=n(24),h=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor",i.fn=function(t,n){var o=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",r=y.getFn(""+o+this.name);return r?r.call(this,t,n):e.fn?e.fn.call(this,t,n):void n(null,t)},i.addFeature("processor"),i.addFeature("async"),i}return i(t,e),f(t,[{key:"process",value:function(e,t){this.fn.call(this,e,t)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(n,o){n?t.throwError(n,e):t.send(o)})}}]),t}(l),d=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor.sync",i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",o=y.getFn(""+n+this.name);return o?o.call(this,t):e.fn?e.fn.call(this,t):t},i.addFeature("processor"),i.addFeature("sync"),i}return i(t,e),f(t,[{key:"process",value:function(e,t){var n=this.fn.call(this,e);t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(e,n){if(e)throw e;t.send(n)})}}]),t}(l);e.exports={operators:{processor:u,processorSync:a,map:s}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(){return new f}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="sink",i._comment="drive passive source",i}return i(t,e),s(t,[{key:"onSignal",value:function(){this.request()}},{key:"from",value:function(){this.request()}}]),t}(c);e.exports={operators:{sink:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,o){return new l(f.prepareNodeOptions(e,t,n,o,"error handler"))}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=n(23),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="errorhandler",i.fn=e.fn||function(e){},i.addFeature("errorhandler"),i}return i(t,e),s(t,[{key:"onError",value:function(e){var t=this;this.fn(e,function(e){t.send(e)})}}]),t}(c);e.exports={operators:{errors:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={};return n="number"==typeof e?{ms:t}:{comment:e,ms:t},new f(n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="throttle",i.ms=e.ms,i._comment=e.comment||"throttle ("+i.ms+" ms)",i.last=(new Date).getTime(),i.addFeature("filter"),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){var t=(new Date).getTime();t-this.ms>=this.last&&(this.last=t,this.send(e))}}]),t}(c);e.exports={operators:{throttle:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.mode="input",t.comment=e,new p(t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.mode="output",t.comment=e,new p(t)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.comment=e,new p(t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(2),p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return e.mode||(e.mode="input"),(!e.mode||"input"!==e.mode&&"output"!==e.mode)&&(console.warn("invalid endpoint mode [",e.mode,'], use "input" instead'),e.mode="input"),i._type="endpoint."+e.mode,i._name=i._comment,i.addFeature("endpoint"),i.addFeature(e.mode),i}return i(t,e),f(t,[{key:"accept",value:function(e){var t=this.options.filter||[];if(0===t.length)return!0;var n=!1,o=!0,r=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(o=(u=a.next()).done);o=!0){var s=u.value;n=!0;for(var c in s)if(e.get(c)!==s[c]){n=!1;break}if(n)break}}catch(e){r=!0,i=e}finally{try{!o&&a.return&&a.return()}finally{if(r)throw i}}return n&&this.invokeObservers("enter endpoint",e),n}},{key:"act",value:function(e,t){t(),this.invokeObservers("leave endpoint",e)}},{key:"preventMetaPropagation",value:function(){return"input"===this.options.mode}}]),t}(l);e.exports={sources:{endpoint:s,input:u,output:a}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={};return n=t?{comment:e,ref:t}:{comment:"go to "+e._comment,ref:e},new f(n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._ref=e.ref,i._type="reference",i.addFeature("reference"),i.addFeature("actuator"),i}return i(t,e),s(t,[{key:"act",value:function(e,t){this._ref&&this._ref.push(e),t()}}]),t}(c);e.exports={operators:{ref:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e?t.comment=e:t=e,new l(t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(o)},f=n(2),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="node",i.onSignalDelegate=i.options.onSignal,i.onErrorDelegate=i.options.onError,i.onEndDelegate=i.options.onEnd,i.watchDelegate=i.options.watch,i.acceptDelegate=i.options.accept,i.actDelegate=i.options.act,i.processDelegate=i.options.process,i.onNextDelegate=i.options.onNext,i.getStateDelegate=i.options.getState,i.getStateDelegate&&i.addFeature("stateful"),
i.onErrorDelegate&&i.addFeature("errorhandler"),i.watchDelegate&&i.addFeature("sensor"),i.acceptDelegate&&i.addFeature("filter"),i.actDelegate&&i.addFeature("actuator"),i.processDelegate&&i.addFeature("processor"),i.addFeature("general"),i.addFeature("async"),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){return this.onSignalDelegate?this.onSignalDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onSignal",this).call(this,e)}},{key:"onError",value:function(e){return this.onErrorDelegate?this.onErrorDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onError",this).call(this,e)}},{key:"onEnd",value:function(e){return this.onEndDelegate?this.onEndDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onEnd",this).call(this,e)}},{key:"watch",value:function(e){return this.watchDelegate?this.watchDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"watch",this).call(this,e)}},{key:"accept",value:function(e){return this.acceptDelegate?this.acceptDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"accept",this).call(this,e)}},{key:"act",value:function(e,n){return this.actDelegate?this.actDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"act",this).call(this,e,n)}},{key:"process",value:function(e,n){return this.processDelegate?this.processDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"process",this).call(this,e,n)}},{key:"getState",value:function(e,n){return this.getStateDelegate?this.getStateDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getState",this).call(this,e,n)}}]),t}(f);e.exports={operators:{node:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={};return"string"==typeof e?(n.comment=e,n.isEndAtom=t):void 0===e||e===!0?(n.comment="start atom process",n.isEndAtom=!1):(n.comment="end atom process",n.isEndAtom=!0),new f(n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor.sync",i.isEndAtom=e.isEndAtom,i.addFeature("atom"),i.addFeature("sync"),i}return i(t,e),s(t,[{key:"process",value:function(e,t){var n=null;n=this.isEndAtom?e.delTag("__non_interruptible__"):e.setTag("__non_interruptible__",!0),t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(e,n){if(e)throw e;t.send(n)})}}]),t}(c);e.exports={operators:{atom:u}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={};return"string"!=typeof e?(n.comment="transport.outgoing",n.delegator=e):(n.comment=e,n.delegator=t),new v(n)}function a(e,t){var n={};return"string"!=typeof e?(n.comment="transport.incoming",n.delegator=e):(n.comment=e,n.delegator=t),new m(n)}function s(e,t){var n={};return"string"!=typeof e?(n.comment="transport.response",n.delegator=e):(n.comment=e,n.delegator=t),new b(n)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(2),p=n(12),y=n(25),h=n(4).uuid,d=y.Actuator,v=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.outgoing",i.delegator=e.delegator||{},i.addFeature("async"),i.addFeature("transport"),i}return i(t,e),f(t,[{key:"act",value:function(e,t){return this.delegator.handleOutgoingSignal?this.delegator.handleOutgoingSignal(e,function(e,n){return e?t(e):t(null,n)}):t()}},{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():h.v1()}}]),t}(d),m=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.incoming",i.delegator=e.delegator||{},i.addFeature("sensor"),i.addFeature("active"),i.addFeature("async"),i.addFeature("transport"),i.watch(i.options),i}return i(t,e),f(t,[{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():null}},{key:"watch",value:function(){var e=this;this.delegator.listen&&this.delegator.listen(function(t,n){var o=n;p.isSignal(n)||(o=new p(n)),e.delegator.saveContext(t,o),e.send(o)})}}]),t}(l),b=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.response",i._cacheSize=e.cacheSize||20,i._cacheTimeout=e.cacheTimeout||5e3,i.delegator=e.delegator||{},i.addFeature("actuator"),i.addFeature("async"),i.addFeature("transport"),i.cache=new Map,i}return i(t,e),f(t,[{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():null}},{key:"act",value:function(e,t){if(!this.delegator.handleResponseSignal)return t();var n=null;return n=this.delegator.getContext?n=this.delegator.getContext(e):null,this.delegator.handleResponseSignal(n,e,function(e,n){return e?t(e):t(null,n)})}},{key:"onError",value:function(e){var t=this;if(!this.delegator.handleResponseSignal)return this.send(e);var n=null;return n=this.delegator.getContext?n=this.delegator.getContext(e):null,this.delegator.handleResponseSignal(n,e,function(n,o){return n?t.send(e.setError(n)):void(o?t.send(e.setResult(o)):t.send(e))})}}]),t}(d);e.exports={OutgoingTransport:v,IncomingTransport:m,ResponseTransport:b,operators:{req:u,listen:a,resp:s}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n={};return"string"==typeof e?(n.comment=e,n.state=t):(n.comment="checkpoint",n.state=e),new l(n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),f=n(24),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="checkpoint",i.addFeature("checkpoint"),i.addFeature("actuator"),i.addFeature("async"),i.addFeature("stateful"),i.stateFn=function(t,n){var o=Object.prototype.hasOwnProperty.call(i.meta,"namespace")?i.meta.namespace+".":"",r=f.getFn(""+o+i.name);return r?r.call(i,t,n):e.state?e.state.call(i,t,n):void n()},i}return i(t,e),s(t,[{key:"onSignal",value:function(e){this.send(e)}},{key:"getState",value:function(e,t){try{this.stateFn.call(this,e,t)}catch(e){console.error(e)}}}]),t}(c);e.exports={operators:{checkpoint:u}}}])});